pipeline {
    agent  {
        node {
            label 'test'
        }
    }
    environment {
        BRANCH = "${BRANCH}"
        JOB = "${JOB}"
    }
    stages {
        stage('Build Develop') {
            when {
                environment name: 'BRANCH', value: 'develop'
            }
            steps {
                sh './augops/build.sh'
            }
        }
        stage('Deploy Develop') {
            when {
                environment name: 'BRANCH', value: 'develop'
            }
            steps {
                sh './augops/deploy.sh'
            }
        }
        stage('Build Master') {
            when {
                environment name: 'BRANCH', value: 'master'
            }
            steps {
                sh 'chmod a+x ./augops/build.sh'
                sh './augops/build.sh'
            }
        }
        stage('Deploy Master') {
            when {
                environment name: 'BRANCH', value: 'master'
            }
            steps {
                sh 'chmod a+x ./augops/deploy.sh'
                sh './augops/deploy.sh'
            }
        }

    }
}
