# jumpserver细节

 "密码认证"和"密钥认证"是 SSH 连接跳板机时所使用的认证方式(都不选会造成无法使用 SSH 方式连接登录跳板机, 不影响 web 登录)
"Telnet成功正则表达式" telnet设备登陆失败需要设置
"命令存储""录像存储"位置设置
"命令存储""录像存储"修改后, 需要在Jumpserver 会话管理-终端管理 修改terminal的配置 录像存储 命令记录, 然后重启 Jumpserver 服务
设置后重启 koko 才能生效


心跳间隔指的是 koko 和 Gua 等终端向 Jumpserver 发送心跳信息的频率, 如果 Jumpserver 长时间(1个小时)未收到 koko 和 Gua 发送的心跳数据, Jumpserver 则认为该终端也"死掉", 在"会话管理"下的"终端管理"页面会显示该终端已掉线。
![](_v_images/20200526181812588_344143139.png =512x)
"命令存储""录像存储"修改后, 需要在Jumpserver 会话管理-终端管理 修改terminal的配置 录像存储 命令记录, 然后重启 Jumpserver 服务
设置后重启 koko 才能生效

![](_v_images/20200526181835534_1318465883.png =511x)




 "MAF二次认证"勾选会开启全局强制"MFA", 所有 jumpserver 用户必须使用动态口令进行认证登录(即时生效)
 "限制登录失败"和"限制登录时间"设置需要重启 jumpserver 才能生效
 "SSH最大空闲时间"设置需要重启 koko 才能生效
 "密码校验规则"设置立即生效

MFA 即 Google Authenticator, 使用此软件需要APP时间与浏览器时间同步




 "管理用户"是资产上的 root, 或拥有 NOPASSWD: ALL sudo 权限的用户, Jumpserver 使用该用户来推送系统用户、获取资产硬件信息等。管理用户需要在资产上面创建用户及给与相应的权限，所以需要管理员权限
 **"管理用户"是给 Jumpserver 服务使用**, 是一个服务账户(和系统用户的区别是, 系统用户是给用户登陆资产使用的)
 "名称" 不能重复
 "ssh私钥" 如果私钥有密码, 请把key的密码填在密码栏上, 目前仅支持 RSA DSA 格式私钥


 "系统用户"是 Jumpserver 跳转登录资产时使用的用户, 用户使用该用户登录资产(授权时指定系统用户, 用户连接资产将会使用此系统用户登陆资产)
 "自动生成密码"、"自动推送"、"Sudo"等功能需要对应资产的"管理用户"有相应的权限, 否则自动推送失败
 ssh 协议的 "Sudo" 栏设定用户的 sudo 权限,
 ssh 协议如果创建的"系统用户"已在资产上面存在, "推送"将会覆盖掉原用户的"home"目录权限(注: 替换成700权限)
 ssh 协议的 "ssh私钥" 如果私钥有密码, 请把key的密码填在密码栏上, 目前仅支持 RSA DSA 格式私钥
 目前 telnet 和 vnc 协议不支持自动推送
 这里简单举几个 "sudo" 设置例子
Sudo /bin/su   当前系统用户可以免sudo密码执行sudo su命令
Sudo /usr/bin/git, /usr/bin/php, /bin/cat, /bin/more, /bin/less, /usr/bin/tail
 当前系统用户可以免sudo密码执行git php cat more less tail
Sudo !/usr/bin/yum   当前系统用户不可以执行sudo yum命令
 此处的权限应该根据使用用户的需求汇总后定制, 原则上给予最小权限即可
 "系统用户"创建时, 如果选择了"自动推送" Jumpserver 会使用"Ansible"自动推送系统用户到资产中, "root"用户不支持推送
 如果资产不支持"Ansible", 请去掉"自动生成密钥"、"自动推送"勾选。手动填写资产上已有的账号及账号密码, 目前支持 Windows 系统用户推送
 如果想让用户登录资产时自己输入密码, 可以在创建系统用户时选择"手动登录"


## 命令过滤

 "系统用户"可以绑定一些"命令过滤器"，一个过滤器可以定义一些"规则"
 当"用户"使用这个"系统用户"登录资产，然后执行一个命令 这个命令需要被绑定过滤器的所有规则匹配，高优先级先被匹配
 当一个规则匹配到了，如果规则的动作是 "允许" 这个命令会被放行； 如果规则的动作是 "禁止" 命令将会被禁止执行； 否则就匹配下一个规则，如果最后没有匹配到规则，则允许执行


## 网域网关

 "网域"功能是为了解决部分环境无法直接连接而新增的功能, 原理是通过网关服务器进行跳转登录
 点击页面左侧的"网域列表"按钮, 查看所有网域列表
 点击页面左上角的"创建网域"按钮, 进入网域创建页面, 选择资产里用作网域的网关服务器
注：混合云适用

Pasted from <https://jumpserver.readthedocs.io/zh/master/quick_start.htmlid2> 


## 终端管理
终端列表页面列出了 Jumpserver 正在使用的终端有哪些, 例如：koko、Gua 等。终端第一次使用, 会首先向 Jumpserver 发送请求注册, 在 Jumpserver 中接受注册后就可以正常使用该终端了。

## 任务列表
作业是 Jumpserver 向其所管理下的资产发送的指令, 例如, 测试资产可连接性、获取资产硬件信息、测试管理用户可连接性和测试系统用户可连接性等命令。默认展示最近7天的作业记录

![](_v_images/20200526181925031_211469622.png =511x)

